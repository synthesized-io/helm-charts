mode: self-hosted

api:
  name: governor-api
  group: governor-api
  image:
    repository: eu.gcr.io/synthesized-cloud-275014/testing-suite-api
    pullPolicy: Always
  container:
    port: 8081
    grpcPort: 50055
    config:
      SPRING_PROFILES_ACTIVE: dev
      VERSION: 'not-specified'
    # Sensitive configuration variables that will be rendered as a new secret
    secretConfig:
      SPRING_DATASOURCE_URL: ""
      SPRING_DATASOURCE_USERNAME: ""
      SPRING_DATASOURCE_PASSWORD: ""
      JWT_SECRET: ""
  service:
    type: ClusterIP
    port: 80
    grpcPort: 50055
  resources:
    requests:
      cpu: 1000m
      memory: 4Gi
    limits:
      cpu: 1200m
      memory: 4608Mi
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

front:
  name: governor-front
  group: governor-front
  image:
    repository: eu.gcr.io/synthesized-cloud-275014/testing-suite-front
    pullPolicy: Always
  container:
    port: 80
    config:
      # private hosts
      API_INTERNAL_HOST: 'governor-api'
      API_GRPC_INTERNAL_PORT: '50055'
      API_HTTP_INTERNAL_PORT: '80'
      UI_TDK_AGENTS: "false"

    secretConfig:
      POSTHOG_ANALYTICS_API_KEY: ""
  service:
    type: ClusterIP
    port: 80

director:
  name: governor-director
  group: governor-director
  image:
    repository: eu.gcr.io/synthesized-cloud-275014/director
    pullPolicy: Always
  container:
    port: 50051
    config:
      OPENAI_API_VERSION: "2023-03-15-preview"
      AZURE_DEPLOYMENT: "gpt-35-turbo"
      AZURE_OPENAI_ENDPOINT: "https://director-openai.openai.azure.com/"
    secretConfig:
      AZURE_OPENAI_API_KEY: ""
      DATABASE_URL_POSTGRES: ""
    healthchecks:
  service:
    type: ClusterIP
    port: 50051

nodeSelector: {}

tolerations: []

affinity: {}

ingress:
  enabled: true
  annotations:
    kubernetes.io/ingress.class: webapprouting.kubernetes.azure.com
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    kubernetes.io/tls-acme: "true"
  hosts:
    - host: dev.web.synthesized.io
      paths:
        - path: /
          service: governor-front
          servicePort: 80
        - path: /api
          service: governor-api
          servicePort: 8081
  tls:
    - secretName: tls-secret
      hosts:
        - dev.web.synthesized.io

grpcIngress:
  enabled: true
  annotations:
    nginx.ingress.kubernetes.io/backend-protocol: "GRPC"
    kubernetes.io/ingress.class: webapprouting.kubernetes.azure.com
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    kubernetes.io/tls-acme: "true"
  hosts:
    - host: dev.grpc.web.synthesized.io
      paths:
        - path: /
          service: governor-api
          servicePort: 50055
  tls:
    - secretName: grpc-tls-secret
      hosts:
        - dev.grpc.web.synthesized.io
